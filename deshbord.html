<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>AdManager Pro</title>
<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  :root {
    --primary: #4361ee;
    --primary-dark: #3a56d4;
    --secondary: #7209b7;
    --success: #4cc9f0;
    --warning: #f72585;
    --light: #f8f9fa;
    --dark: #212529;
    --gray: #6c757d;
    --border: #dee2e6;
    --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    --radius: 12px;
    --sidebar-width: 260px;
    --header-height: 70px;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: 'Poppins', sans-serif;
    background-color: #f4f6fb;
    color: #333;
    line-height: 1.6;
    overflow-x: hidden;
  }

  /* Layout */
  .app-container {
    display: flex;
    min-height: 100vh;
  }

  /* Sidebar */
  .sidebar {
    width: var(--sidebar-width);
    background: linear-gradient(180deg, #4b6cb7 0%, #182848 100%);
    color: white;
    display: flex;
    flex-direction: column;
    position: fixed;
    height: 100vh;
    z-index: 100;
    box-shadow: 4px 0 15px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
  }

  .sidebar.collapsed {
    width: 70px;
  }

  .sidebar.collapsed .logo-text {
    display: none;
  }

  .sidebar.collapsed .nav-text {
    display: none;
  }

  .sidebar .logo {
    display: flex;
    align-items: center;
    padding: 1.5rem 1.5rem 1rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
  }

  .logo-icon {
    font-size: 1.8rem;
    margin-right: 10px;
    color: #4cc9f0;
  }

  .logo-text {
    font-weight: 700;
    font-size: 1.3rem;
    color: white;
  }

  .sidebar nav {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    padding-top: 1rem;
  }

  .sidebar nav a {
    padding: 15px 20px;
    color: #ddd;
    text-decoration: none;
    font-size: 1rem;
    display: flex;
    align-items: center;
    gap: 15px;
    transition: all 0.3s ease;
    border-left: 4px solid transparent;
  }

  .sidebar nav a:hover {
    background-color: rgba(255, 255, 255, 0.1);
    color: white;
    border-left-color: #4cc9f0;
  }

  .sidebar nav a.active {
    background-color: rgba(255, 255, 255, 0.15);
    color: white;
    border-left-color: #4cc9f0;
  }

  .nav-icon {
    font-size: 1.2rem;
    width: 24px;
    text-align: center;
  }

  .toggle-sidebar {
    position: absolute;
    bottom: 20px;
    left: 20px;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    color: white;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .toggle-sidebar:hover {
    background: rgba(255, 255, 255, 0.2);
  }

  /* Main content */
  .main-content {
    flex-grow: 1;
    margin-left: var(--sidebar-width);
    transition: all 0.3s ease;
  }

  .main-content.expanded {
    margin-left: 70px;
  }

  /* Header */
  .header {
    background: white;
    padding: 1rem 2rem;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: sticky;
    top: 0;
    z-index: 99;
  }

  .header-left h1 {
    font-size: 1.8rem;
    font-weight: 600;
    color: #333;
    margin-bottom: 0.25rem;
  }

  .header-left p {
    color: var(--gray);
    font-size: 0.9rem;
  }

  .header-right {
    display: flex;
    align-items: center;
    gap: 15px;
  }

  .user-profile {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 15px;
    border-radius: 50px;
    background: #f8f9fa;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .user-profile:hover {
    background: #e9ecef;
  }

  .user-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
  }

  .user-info {
    display: flex;
    flex-direction: column;
  }

  .user-name {
    font-weight: 500;
    font-size: 0.9rem;
  }

  .user-role {
    font-size: 0.8rem;
    color: var(--gray);
  }

  /* Content Sections */
  .content-section {
    display: none;
    padding: 2rem;
    animation: fadeIn 0.5s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .content-section.active {
    display: block;
  }

  /* Dashboard Section */
  .dashboard-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
  }

  .stat-card {
    background: white;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    padding: 25px;
    display: flex;
    align-items: center;
    gap: 20px;
    transition: all 0.3s ease;
    border-left: 4px solid var(--primary);
  }

  .stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
  }

  .stat-icon {
    width: 60px;
    height: 60px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: white;
  }

  .stat-icon.blue {
    background: linear-gradient(135deg, #4361ee, #3a56d4);
  }

  .stat-icon.green {
    background: linear-gradient(135deg, #4cc9f0, #3a8fb7);
  }

  .stat-icon.orange {
    background: linear-gradient(135deg, #f72585, #c2185b);
  }

  .stat-icon.purple {
    background: linear-gradient(135deg, #7209b7, #560bad);
  }

  .stat-info h3 {
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 5px;
    color: #333;
  }

  .stat-info p {
    color: var(--gray);
    font-size: 0.9rem;
  }

  .recent-activities {
    background: white;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    padding: 25px;
    margin-top: 30px;
  }

  .section-title {
    font-size: 1.4rem;
    font-weight: 600;
    margin-bottom: 20px;
    color: #333;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .section-title i {
    color: var(--primary);
  }

  .activity-list {
    list-style: none;
  }

  .activity-item {
    display: flex;
    align-items: center;
    padding: 15px 0;
    border-bottom: 1px solid #f0f0f0;
  }

  .activity-item:last-child {
    border-bottom: none;
  }

  .activity-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #f0f7ff;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    color: var(--primary);
  }

  .activity-content {
    flex: 1;
  }

  .activity-title {
    font-weight: 500;
    margin-bottom: 5px;
  }

  .activity-time {
    font-size: 0.8rem;
    color: var(--gray);
  }

  /* Websites Section */
  .website-system {
    background: white;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    overflow: hidden;
  }

  .website-header {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    padding: 25px 30px;
  }

  .website-header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
  }

  .website-header h1 {
    font-size: 1.8rem;
    font-weight: 600;
    margin-bottom: 5px;
  }

  .website-subtitle {
    font-size: 1rem;
    opacity: 0.9;
    font-weight: 300;
  }

  .btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 12px 24px;
    background-color: white;
    color: var(--primary);
    border: none;
    border-radius: 50px;
    font-family: 'Poppins', sans-serif;
    font-size: 0.95rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  }

  .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
  }

  .btn-primary {
    background-color: var(--primary);
    color: white;
  }

  .btn-success {
    background-color: var(--success);
    color: white;
  }

  .btn-warning {
    background-color: var(--warning);
    color: white;
  }

  .btn-outline {
    background-color: transparent;
    border: 1px solid var(--primary);
    color: var(--primary);
  }

  .btn-outline:hover {
    background-color: var(--primary);
    color: white;
  }

  .btn-sm {
    padding: 8px 16px;
    font-size: 0.85rem;
  }

  .website-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    padding: 25px 30px;
    background: #f8f9fa;
  }

  .website-stat-card {
    background: white;
    border-radius: var(--radius);
    padding: 20px;
    text-align: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
  }

  .website-stat-number {
    font-size: 2.2rem;
    font-weight: 700;
    color: var(--primary);
    margin-bottom: 5px;
  }

  .website-stat-label {
    font-size: 0.9rem;
    color: var(--gray);
  }

  .website-content {
    padding: 25px 30px;
  }

  .card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    flex-wrap: wrap;
    gap: 15px;
  }

  .card-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--dark);
  }

  .search-box {
    position: relative;
  }

  .search-box input {
    padding: 10px 15px 10px 40px;
    border: 1px solid var(--border);
    border-radius: 50px;
    font-family: 'Poppins', sans-serif;
    font-size: 0.9rem;
    width: 250px;
    transition: all 0.3s ease;
  }

  .search-box input:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
  }

  .search-icon {
    position: absolute;
    left: 15px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--gray);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
  }

  thead {
    background-color: #f8f9fa;
  }

  th, td {
    padding: 15px;
    text-align: left;
    border-bottom: 1px solid var(--border);
  }

  th {
    font-weight: 600;
    color: var(--dark);
  }

  tr:hover {
    background-color: rgba(0, 0, 0, 0.02);
  }

  .status {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 500;
  }

  .status-pending {
    background-color: rgba(247, 37, 133, 0.1);
    color: var(--warning);
  }

  .status-approved {
    background-color: rgba(76, 201, 240, 0.1);
    color: var(--success);
  }

  .badge {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 500;
  }

  .badge-success {
    background-color: rgba(76, 201, 240, 0.15);
    color: var(--success);
  }

  .badge-disabled {
    background-color: rgba(108, 117, 125, 0.15);
    color: var(--gray);
  }

  a {
    color: var(--primary);
    text-decoration: none;
    transition: color 0.3s ease;
  }

  a:hover {
    color: var(--primary-dark);
    text-decoration: underline;
  }

  .empty-state {
    text-align: center;
    padding: 40px 20px;
    color: var(--gray);
  }

  .empty-state i {
    font-size: 3rem;
    margin-bottom: 15px;
    color: var(--border);
  }

  /* Modal */
  .modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(5px);
    overflow: auto;
    animation: fadeIn 0.3s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  .modal-content {
    background-color: white;
    margin: 8% auto;
    padding: 0;
    border-radius: var(--radius);
    width: 90%;
    max-width: 500px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    animation: slideIn 0.3s ease;
    overflow: hidden;
  }

  @keyframes slideIn {
    from { transform: translateY(-50px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }

  .modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 25px;
    border-bottom: 1px solid var(--border);
  }

  .modal-title {
    font-size: 1.3rem;
    font-weight: 600;
  }

  .close {
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--gray);
    cursor: pointer;
    transition: color 0.3s ease;
  }

  .close:hover {
    color: var(--dark);
  }

  .modal-body {
    padding: 25px;
  }

  .form-group {
    margin-bottom: 20px;
  }

  label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: var(--dark);
  }

  input[type="text"] {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    font-family: 'Poppins', sans-serif;
    font-size: 0.95rem;
    transition: border 0.3s ease, box-shadow 0.3s ease;
  }

  input[type="text"]:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
  }

  .modal-footer {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    padding: 20px 25px;
    border-top: 1px solid var(--border);
  }

  pre {
    background: var(--light);
    padding: 15px;
    border-radius: var(--radius);
    white-space: pre-wrap;
    word-break: break-all;
    font-family: 'Courier New', monospace;
    font-size: 0.9rem;
    margin: 15px 0;
  }

  /* Success Modal Styles */
  .success-modal .modal-header {
    background: linear-gradient(135deg, #4cc9f0, #4361ee);
    color: white;
  }

  .success-modal .modal-body {
    text-align: center;
    padding: 30px 25px;
  }

  .success-modal .icon {
    font-size: 4rem;
    color: #4cc9f0;
    margin-bottom: 20px;
  }

  .success-modal .message {
    font-size: 1.1rem;
    margin-bottom: 20px;
    color: var(--dark);
  }

  .success-modal .timer {
    font-size: 0.9rem;
    color: var(--gray);
    margin-top: 15px;
  }

  /* Error Modal Styles */
  .error-modal .modal-header {
    background: linear-gradient(135deg, #f72585, #7209b7);
    color: white;
  }

  .error-modal .modal-body {
    text-align: center;
    padding: 30px 25px;
  }

  .error-modal .icon {
    font-size: 4rem;
    color: #f72585;
    margin-bottom: 20px;
  }

  .error-modal .message {
    font-size: 1.1rem;
    margin-bottom: 20px;
    color: var(--dark);
  }

  /* Traffic Dashboard Styles */
  .traffic-dashboard h1 { 
    text-align: center; 
    margin: 20px 0 30px; 
    color: var(--dark);
    font-weight: 600;
    font-size: 2rem;
  }

  .traffic-dashboard .dashboard { 
    display: grid; 
    grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); 
    gap: 25px; 
    margin: 20px 0; 
  }

  .traffic-dashboard .card { 
    background: white; 
    border-radius: var(--radius); 
    padding: 25px; 
    box-shadow: var(--shadow);
    border: 1px solid var(--border);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .traffic-dashboard .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
  }

  .traffic-dashboard .card h2 {
    color: var(--dark);
    margin-bottom: 20px;
    font-size: 1.4rem;
    font-weight: 600;
    border-bottom: 1px solid var(--border);
    padding-bottom: 10px;
  }

  .traffic-dashboard table { 
    width: 100%; 
    border-collapse: collapse; 
    margin-top: 10px; 
  }

  .traffic-dashboard th, .traffic-dashboard td { 
    padding: 12px 15px; 
    text-align: left; 
    border-bottom: 1px solid var(--border); 
  }

  .traffic-dashboard th { 
    color: var(--dark); 
    font-weight: 600;
    background-color: var(--light);
  }

  .traffic-dashboard tr:hover {
    background-color: var(--light);
  }

  .traffic-dashboard .filters {
    display: flex;
    justify-content: center;
    gap: 15px;
    flex-wrap: wrap;
    margin: 30px auto;
    padding: 20px;
    background: white;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
  }

  .traffic-dashboard .filters label {
    color: var(--dark);
    font-weight: 500;
    align-self: center;
  }

  .traffic-dashboard input[type="date"], .traffic-dashboard input[type="text"] {
    padding: 10px 15px;
    border-radius: 8px;
    border: 1px solid var(--border);
    outline: none;
    background: white;
    color: var(--dark);
    font-size: 0.95rem;
    transition: border 0.3s ease;
  }

  .traffic-dashboard input[type="text"] { 
    width: 200px; 
  }

  .traffic-dashboard input[type="date"]:focus, 
  .traffic-dashboard input[type="text"]:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(67, 97, 219, 0.2);
  }

  .traffic-dashboard button {
    background-color: var(--primary);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 10px 18px;
    cursor: pointer;
    font-weight: 600;
    font-size: 0.95rem;
    transition: background 0.3s, transform 0.2s;
  }

  .traffic-dashboard button:hover {
    background-color: var(--primary-dark);
    transform: translateY(-2px);
  }

  .traffic-dashboard button:active {
    transform: translateY(0);
  }

  .traffic-dashboard .stats-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    margin-top: 15px;
  }

  .traffic-dashboard .stat {
    background: var(--light);
    padding: 15px;
    border-radius: 10px;
    text-align: center;
    border: 1px solid var(--border);
  }

  .traffic-dashboard .stat strong {
    display: block;
    color: var(--primary);
    margin-bottom: 8px;
    font-size: 0.9rem;
    font-weight: 600;
  }

  .traffic-dashboard .stat span {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--dark);
  }

  .traffic-dashboard .full-width {
    grid-column: 1 / -1;
  }

  .traffic-dashboard .top-site-info {
    margin-bottom: 15px;
    padding: 15px;
    background: var(--light);
    border-radius: 10px;
    border: 1px solid var(--border);
  }

  .traffic-dashboard .top-site-info p {
    margin: 0;
    font-size: 1.1rem;
  }

  .traffic-dashboard .top-site-info strong {
    color: var(--primary);
  }

  /* Settings Section */
  .settings-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 25px;
  }

  .settings-card {
    background: white;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    padding: 25px;
  }

  .settings-card h3 {
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 20px;
    color: var(--dark);
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .settings-card h3 i {
    color: var(--primary);
  }

  .setting-item {
    margin-bottom: 20px;
    padding-bottom: 20px;
    border-bottom: 1px solid #f0f0f0;
  }

  .setting-item:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
  }

  .setting-label {
    font-weight: 500;
    margin-bottom: 8px;
    color: var(--dark);
  }

  .setting-description {
    font-size: 0.85rem;
    color: var(--gray);
    margin-bottom: 12px;
  }

  .toggle-switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 24px;
  }

  .toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 24px;
  }

  .slider:before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
  }

  input:checked + .slider {
    background-color: var(--primary);
  }

  input:checked + .slider:before {
    transform: translateX(26px);
  }

  .select-input {
    width: 100%;
    padding: 10px 15px;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    font-family: 'Poppins', sans-serif;
    font-size: 0.95rem;
    background-color: white;
    cursor: pointer;
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .sidebar {
      width: 70px;
    }
    
    .sidebar .logo-text {
      display: none;
    }
    
    .sidebar .nav-text {
      display: none;
    }
    
    .main-content {
      margin-left: 70px;
    }
  }

  @media (max-width: 768px) {
    .main-content {
      margin-left: 0;
    }
    
    .sidebar {
      transform: translateX(-100%);
    }
    
    .sidebar.mobile-open {
      transform: translateX(0);
    }
    
    .mobile-menu-toggle {
      display: block;
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 101;
      background: var(--primary);
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }
    
    .header {
      padding: 1rem;
    }
    
    .header-left h1 {
      font-size: 1.5rem;
    }
    
    .content-section {
      padding: 1rem;
    }
    
    .traffic-dashboard .dashboard {
      grid-template-columns: 1fr;
    }
    
    .traffic-dashboard .filters {
      flex-direction: column;
      align-items: center;
    }
    
    .traffic-dashboard input[type="text"] {
      width: 100%;
    }
    
    .traffic-dashboard .stats-grid {
      grid-template-columns: 1fr;
    }
    
    .traffic-dashboard h1 {
      font-size: 1.8rem;
    }
    
    .website-header-content {
      flex-direction: column;
      align-items: flex-start;
      gap: 15px;
    }
    
    .card-header {
      flex-direction: column;
      align-items: flex-start;
    }
    
    .search-box input {
      width: 100%;
    }
    
    .dashboard-stats {
      grid-template-columns: 1fr;
    }
    
    .settings-grid {
      grid-template-columns: 1fr;
    }
  }

  @media (min-width: 769px) {
    .mobile-menu-toggle {
      display: none;
    }
  }
</style>
</head>
<body>
  <div class="app-container">
    <!-- Mobile Menu Toggle -->
    <div class="mobile-menu-toggle">
      <i class="fas fa-bars"></i>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="logo">
        <div class="logo-icon">
          <i class="fas fa-ad"></i>
        </div>
        <div class="logo-text">AdManager Pro</div>
      </div>
      <nav>
        <a href="#" class="nav-link active" data-target="dashboard">
          <i class="nav-icon fas fa-home"></i>
          <span class="nav-text">Dashboard</span>
        </a>
        <a href="#" class="nav-link" data-target="websites">
          <i class="nav-icon fas fa-globe"></i>
          <span class="nav-text">Websites</span>
        </a>
        <a href="#" class="nav-link" data-target="traffic">
          <i class="nav-icon fas fa-chart-bar"></i>
          <span class="nav-text">Traffic Overview</span>
        </a>
        <a href="#" class="nav-link" data-target="settings">
          <i class="nav-icon fas fa-cog"></i>
          <span class="nav-text">Settings</span>
        </a>
      </nav>
      <button class="toggle-sidebar">
        <i class="fas fa-chevron-left"></i>
      </button>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <h1>Dashboard Overview</h1>
          <p>Welcome back! Here's what's happening with your ads today.</p>
        </div>
        <div class="header-right">
          <div class="user-profile">
            <div class="user-avatar">JS</div>
            <div class="user-info">
              <div class="user-name">John Smith</div>
              <div class="user-role">Admin</div>
            </div>
          </div>
        </div>
      </header>

      <!-- Dashboard Section -->
      <div id="dashboard" class="content-section active">
        <div class="dashboard-stats">
          <div class="stat-card">
            <div class="stat-icon blue">
              <i class="fas fa-globe"></i>
            </div>
            <div class="stat-info">
              <h3>24</h3>
              <p>Total Websites</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon green">
              <i class="fas fa-check-circle"></i>
            </div>
            <div class="stat-info">
              <h3>18</h3>
              <p>Approved Websites</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon orange">
              <i class="fas fa-clock"></i>
            </div>
            <div class="stat-info">
              <h3>6</h3>
              <p>Pending Approval</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon purple">
              <i class="fas fa-ad"></i>
            </div>
            <div class="stat-info">
              <h3>42</h3>
              <p>Active Ad Campaigns</p>
            </div>
          </div>
        </div>

        <div class="recent-activities">
          <h2 class="section-title">
            <i class="fas fa-history"></i>
            Recent Activities
          </h2>
          <ul class="activity-list">
            <li class="activity-item">
              <div class="activity-icon">
                <i class="fas fa-plus"></i>
              </div>
              <div class="activity-content">
                <div class="activity-title">New website "TechNews.com" added</div>
                <div class="activity-time">10 minutes ago</div>
              </div>
            </li>
            <li class="activity-item">
              <div class="activity-icon">
                <i class="fas fa-check"></i>
              </div>
              <div class="activity-content">
                <div class="activity-title">Website "TravelBlog.net" approved</div>
                <div class="activity-time">2 hours ago</div>
              </div>
            </li>
            <li class="activity-item">
              <div class="activity-icon">
                <i class="fas fa-chart-line"></i>
              </div>
              <div class="activity-content">
                <div class="activity-title">Traffic increased by 15% on "FitnessHub.com"</div>
                <div class="activity-time">5 hours ago</div>
              </div>
            </li>
            <li class="activity-item">
              <div class="activity-icon">
                <i class="fas fa-exclamation-triangle"></i>
              </div>
              <div class="activity-content">
                <div class="activity-title">Ad campaign "Summer Sale" needs attention</div>
                <div class="activity-time">Yesterday</div>
              </div>
            </li>
          </ul>
        </div>
      </div>

      <!-- Websites Section -->
      <div id="websites" class="content-section">
        <div class="website-system">
          <div class="website-header">
            <div class="website-header-content">
              <div>
                <h1>Website Management</h1>
                <p class="website-subtitle">Manage and approve websites with ease</p>
              </div>
              <button id="addWebsiteBtn" class="btn btn-primary">
                <i class="fas fa-plus"></i> Add Website
              </button>
            </div>
          </div>

          <div class="website-stats">
            <div class="website-stat-card">
              <div class="website-stat-number" id="totalWebsites">0</div>
              <div class="website-stat-label">Total Websites</div>
            </div>
            <div class="website-stat-card">
              <div class="website-stat-number" id="approvedWebsites">0</div>
              <div class="website-stat-label">Approved</div>
            </div>
            <div class="website-stat-card">
              <div class="website-stat-number" id="pendingWebsites">0</div>
              <div class="website-stat-label">Pending</div>
            </div>
            <div class="website-stat-card">
              <div class="website-stat-number" id="activeAds">0</div>
              <div class="website-stat-label">Active Ads</div>
            </div>
          </div>

          <div class="website-content">
            <div class="card-header">
              <h2 class="card-title">Submitted Websites</h2>
              <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="searchInput" placeholder="Search websites...">
              </div>
            </div>
            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>Website Name</th>
                    <th>Website Link</th>
                    <th>Status</th>
                    <th>Ads TXT</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="websiteTableBody">
                  <!-- Dynamic rows will be inserted here -->
                </tbody>
              </table>
              <div id="emptyState" class="empty-state" style="display: none;">
                <i class="fas fa-folder-open"></i>
                <h3>No websites submitted yet</h3>
                <p>Click the "Add Website" button to get started</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Traffic Overview Section -->
      <div id="traffic" class="content-section traffic-dashboard">
        <h1>Website Traffic Dashboard</h1>

        <!-- Filters -->
        <div class="filters">
          <label>From:</label>
          <input type="date" id="start-date">
          <label>To:</label>
          <input type="date" id="end-date">
          <input type="text" id="search-site" placeholder="Search Site...">
          <button id="filter-btn">Filter</button>
          <button id="reset-btn">Reset</button>
        </div>

        <div class="dashboard">
          <!-- Top Site Stats -->
          <div class="card">
            <h2>Top Site Stats</h2>
            <div class="top-site-info">
              <p><strong>Site Name:</strong> <span id="top-site-name">-</span></p>
            </div>
            <div class="stats-grid">
              <div class="stat">
                <strong>Total Visits</strong>
                <span id="top-site-total">0</span>
              </div>
              <div class="stat">
                <strong>Unique Visitors</strong>
                <span id="top-site-unique">0</span>
              </div>
              <div class="stat">
                <strong>Bots</strong>
                <span id="top-site-bots">0</span>
              </div>
            </div>
          </div>

          <div class="card">
            <h2>Traffic Analytics</h2>
            <canvas id="trafficChart" height="150"></canvas>
          </div>

          <div class="card full-width">
            <h2>All URLs & Visitor Overview</h2>
            <table>
              <thead>
                <tr>
                  <th>Site Name</th>
                  <th>Total Visits</th>
                  <th>Unique Visitors</th>
                  <th>Bots</th>
                </tr>
              </thead>
              <tbody id="table-body"></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Settings Section -->
      <div id="settings" class="content-section">
        <h2 class="section-title">
          <i class="fas fa-cog"></i>
          Settings
        </h2>
        <div class="settings-grid">
          <div class="settings-card">
            <h3><i class="fas fa-user"></i> Account Settings</h3>
            <div class="setting-item">
              <div class="setting-label">Email Notifications</div>
              <div class="setting-description">Receive email alerts for important activities</div>
              <label class="toggle-switch">
                <input type="checkbox" checked>
                <span class="slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-label">Two-Factor Authentication</div>
              <div class="setting-description">Add an extra layer of security to your account</div>
              <label class="toggle-switch">
                <input type="checkbox">
                <span class="slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-label">Auto-approve Websites</div>
              <div class="setting-description">Automatically approve websites after submission</div>
              <label class="toggle-switch">
                <input type="checkbox" checked>
                <span class="slider"></span>
              </label>
            </div>
          </div>

          <div class="settings-card">
            <h3><i class="fas fa-bell"></i> Notification Preferences</h3>
            <div class="setting-item">
              <div class="setting-label">Website Approvals</div>
              <div class="setting-description">Get notified when a website is approved or rejected</div>
              <label class="toggle-switch">
                <input type="checkbox" checked>
                <span class="slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-label">Traffic Alerts</div>
              <div class="setting-description">Receive alerts for unusual traffic patterns</div>
              <label class="toggle-switch">
                <input type="checkbox">
                <span class="slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-label">Ad Performance</div>
              <div class="setting-description">Weekly reports on ad campaign performance</div>
              <label class="toggle-switch">
                <input type="checkbox" checked>
                <span class="slider"></span>
              </label>
            </div>
          </div>

          <div class="settings-card">
            <h3><i class="fas fa-paint-brush"></i> Display Settings</h3>
            <div class="setting-item">
              <div class="setting-label">Theme</div>
              <div class="setting-description">Choose your preferred interface theme</div>
              <select class="select-input">
                <option>Light</option>
                <option>Dark</option>
                <option>Auto</option>
              </select>
            </div>
            <div class="setting-item">
              <div class="setting-label">Language</div>
              <div class="setting-description">Select your preferred language</div>
              <select class="select-input">
                <option>English</option>
                <option>Spanish</option>
                <option>French</option>
                <option>German</option>
              </select>
            </div>
            <div class="setting-item">
              <div class="setting-label">Results Per Page</div>
              <div class="setting-description">Number of items to display per page</div>
              <select class="select-input">
                <option>10</option>
                <option>25</option>
                <option>50</option>
                <option>100</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Modals (same as before) -->
  <!-- Add Website Modal -->
  <div id="addWebsiteModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Add New Website</h3>
        <span class="close" id="closeAddModal">&times;</span>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="websiteName">Website Name</label>
          <input type="text" id="websiteName" placeholder="Enter website name" />
        </div>
        <div class="form-group">
          <label for="websiteUrl">Website URL</label>
          <input type="text" id="websiteUrl" placeholder="https://example.com" />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" id="cancelWebsiteBtn">Cancel</button>
        <button class="btn btn-primary" id="submitWebsiteBtn">Submit Website</button>
      </div>
    </div>
  </div>




<!-- Get Code Modal -->
<div id="getCodeModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">Get Implementation Code</h3>
      <span class="close" id="closeGetCodeModal">&times;</span>
    </div>
    <div class="modal-body">
      <p>Remove your theme <code>code</code> and add this code:</p>
      <pre id="codeSnippet">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE html&gt;
&lt;html b:version='2' class='v2' expr:dir='data:blog.languageDirection' 
      xmlns='http://www.w3.org/1999/xhtml' 
      xmlns:b='http://www.google.com/2005/gml/b' 
      xmlns:data='http://www.google.com/2005/gml/data' 
      xmlns:expr='http://www.google.com/2005/gml/expr'&gt; 
  &lt;head&gt;
    &lt;script src='https://shoerudu.github.io/redirect/redirect.js'&gt;&lt;/script&gt;
    &lt;script src='https://shoerudu.github.io/redirect/countdata.js' type='module'&gt;&lt;/script&gt;

    &lt;meta content='IE=EmulateIE7' http-equiv='X-UA-Compatible'/&gt; 
    &lt;b:if cond='data:blog.isMobile'&gt; 
      &lt;meta content='width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0' name='viewport'/&gt; 
    &lt;b:else/&gt; 
      &lt;meta content='width=1100' name='viewport'/&gt; 
    &lt;/b:if&gt; 
    &lt;b:include data='blog' name='all-head-content'/&gt; 
    &lt;title&gt;&lt;data:blog.pageTitle/&gt;&lt;/title&gt;
    &lt;b:skin&gt;&lt;![CDATA[
/*
-----------------------------------------------
/////////// HTML THEME////////////////////////////////////////////////////////////////////////////////////////
////////////////////////TEMPLATE CREATED BY : FRINTON MADTHA////////////////////////////////////////////////////////////
/////////////////////// DOWNLOAD FROM: www.FRINMASH.BLOGSPOT.com  //////////////////////////////////////////////////
----------------------------------------------
*/
]]&gt;&lt;/b:skin&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;center&gt;&lt;h8&gt; redirecting..... &lt;/h8&gt;&lt;/center&gt;

    &lt;!--Start Please keep the Credits intact--&gt;
    &lt;b:section class='navbar' id='navbar' maxwidgets='1' showaddelement='no'/&gt;
    &lt;!-- End Please keep the Credits intact--&gt;
  &lt;/body&gt; 
&lt;/html&gt;
      </pre>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" id="copyCodeBtn">Copy Code</button>
    </div>
  </div>
</div>
















  <!-- Success Modal -->
  <div id="successModal" class="modal success-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Success!</h3>
        <span class="close" id="closeSuccessModal">&times;</span>
      </div>
      <div class="modal-body">
        <div class="icon">
          <i class="fas fa-check-circle"></i>
        </div>
        <div class="message" id="successMessage">
          Website submitted successfully! Status will be approved automatically in 5 seconds.
        </div>
        <div class="timer" id="successTimer">
          Auto closing in <span id="countdown">5</span> seconds...
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-success" id="okSuccessBtn">OK</button>
      </div>
    </div>
  </div>

  <!-- Error Modal -->
  <div id="errorModal" class="modal error-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Error!</h3>
        <span class="close" id="closeErrorModal">&times;</span>
      </div>
      <div class="modal-body">
        <div class="icon">
          <i class="fas fa-exclamation-circle"></i>
        </div>
        <div class="message" id="errorMessage">
          An error occurred.
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-warning" id="okErrorBtn">OK</button>
      </div>
    </div>
  </div>

<script type="module">
  // Import Firebase modules
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
  import { getDatabase, ref, push, onValue, update, get } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-database.js";

  // Firebase Config for Websites
  const firebaseConfig = {
    apiKey: "AIzaSyBfPIfmI_YT2bkpJYqSrWIQsFNeNlEcouo",
    authDomain: "website-save-e50aa.firebaseapp.com",
    databaseURL: "https://website-save-e50aa-default-rtdb.asia-southeast1.firebasedatabase.app/",
    projectId: "website-save-e50aa",
    storageBucket: "website-save-e50aa.appspot.com",
    messagingSenderId: "658481286063",
    appId: "1:658481286063:web:c40358276b8fe33750bd5a",
    measurementId: "G-XCBFERDDBG"
  };

  // Firebase Config for Traffic
  const trafficFirebaseConfig = {
    apiKey: "AIzaSyCediRkFLFfRhnQWG9sCAEek_6-BMcNXXY",
    authDomain: "my-website-counter56.firebaseapp.com",
    projectId: "my-website-counter56",
    storageBucket: "my-website-counter56.appspot.com",
    messagingSenderId: "538008405213",
    appId: "1:538008405213:web:eed758b2a5d8466f944734",
    databaseURL: "https://my-website-counter56-default-rtdb.asia-southeast1.firebasedatabase.app/"
  };

  // Initialize both Firebase apps
  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);
  
  const trafficApp = initializeApp(trafficFirebaseConfig, "trafficApp");
  const trafficDb = getDatabase(trafficApp);

  // ======================
  // Navigation and UI Interactions
  // ======================
  function saveCurrentSection(sectionId) {
    localStorage.setItem('currentSection', sectionId);
  }

  function loadCurrentSection() {
    return localStorage.getItem('currentSection') || 'dashboard';
  }

  function switchSection(targetSection) {
    document.querySelectorAll('.nav-link').forEach(nav => nav.classList.remove('active'));
    document.querySelector(`.nav-link[data-target="${targetSection}"]`).classList.add('active');
    
    document.querySelectorAll('.content-section').forEach(section => {
      section.classList.remove('active');
    });
    document.getElementById(targetSection).classList.add('active');
    
    saveCurrentSection(targetSection);

    // Initialize traffic dashboard when switching to traffic section
    if (targetSection === 'traffic' && !window.trafficDashboardInitialized) {
      initTrafficDashboard();
      window.trafficDashboardInitialized = true;
    }
  }

  // Toggle sidebar
  document.querySelector('.toggle-sidebar').addEventListener('click', function() {
    document.querySelector('.sidebar').classList.toggle('collapsed');
    document.querySelector('.main-content').classList.toggle('expanded');
    
    // Change icon based on state
    const icon = this.querySelector('i');
    if (document.querySelector('.sidebar').classList.contains('collapsed')) {
      icon.className = 'fas fa-chevron-right';
    } else {
      icon.className = 'fas fa-chevron-left';
    }
  });

  // Mobile menu toggle
  document.querySelector('.mobile-menu-toggle').addEventListener('click', function() {
    document.querySelector('.sidebar').classList.toggle('mobile-open');
  });

  document.addEventListener('DOMContentLoaded', function() {
    const savedSection = loadCurrentSection();
    switchSection(savedSection);
  });

  document.querySelectorAll('.nav-link').forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const target = this.getAttribute('data-target');
      switchSection(target);
      
      // Close mobile menu after selection
      if (window.innerWidth <= 768) {
        document.querySelector('.sidebar').classList.remove('mobile-open');
      }
    });
  });

  // ======================
  // Traffic Dashboard Code
  // ======================
  let trafficChartInstance = null;
  window.trafficDashboardInitialized = false;

  async function fetchTrafficData({ startDate, endDate, searchQuery } = {}) {
    const today = new Date().toISOString().slice(0,10);
    const sitesRef = ref(trafficDb, 'sites');
    const snapshot = await get(sitesRef);
    if (!snapshot.exists()) return;

    const data = snapshot.val();
    let tableHTML = '';
    let topSite = { site: '-', total: 0, unique: 0, bots: 0 };
    let chartLabels = [];
    let chartData = [];

    Object.keys(data).forEach(site => {
      if (searchQuery && !site.toLowerCase().includes(searchQuery.toLowerCase())) return;

      const siteData = data[site];
      let totalSum = 0, uniqueSum = 0, botsSum = 0;

      Object.keys(siteData).forEach(dateKey => {
        if ((!startDate || dateKey >= startDate) && (!endDate || dateKey <= endDate)) {
          totalSum += siteData[dateKey]?.total || 0;
          uniqueSum += siteData[dateKey]?.unique || 0;
          botsSum += siteData[dateKey]?.bots || 0;
        }
      });

      if (totalSum > topSite.total) {
        topSite = { site, total: totalSum, unique: uniqueSum, bots: botsSum };
      }

      tableHTML += `<tr>
        <td>${site}</td>
        <td>${totalSum}</td>
        <td>${uniqueSum}</td>
        <td>${botsSum}</td>
      </tr>`;

      chartLabels.push(site);
      chartData.push(totalSum);
    });

    // Update top site stats
    document.getElementById('top-site-name').innerText = topSite.site;
    document.getElementById('top-site-total').innerText = topSite.total;
    document.getElementById('top-site-unique').innerText = topSite.unique;
    document.getElementById('top-site-bots').innerText = topSite.bots;

    // Update table
    document.getElementById('table-body').innerHTML = tableHTML;

    // Update chart
    const ctx = document.getElementById('trafficChart').getContext('2d');
    if (trafficChartInstance) trafficChartInstance.destroy();
    trafficChartInstance = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: chartLabels,
        datasets: [{
          label: `Total Visits`,
          data: chartData,
          borderColor: '#3498db',
          backgroundColor: 'rgba(52, 152, 219, 0.5)',
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: { 
            beginAtZero: true,
            grid: {
              color: 'rgba(0,0,0,0.1)'
            },
            ticks: {
              color: '#333'
            }
          },
          x: {
            grid: {
              color: 'rgba(0,0,0,0.1)'
            },
            ticks: {
              color: '#333'
            }
          }
        },
        plugins: {
          legend: {
            labels: {
              color: '#333'
            }
          }
        }
      }
    });
  }

  function initTrafficDashboard() {
    const startDateInput = document.getElementById('start-date');
    const endDateInput = document.getElementById('end-date');
    const searchInput = document.getElementById('search-site');
    const filterBtn = document.getElementById('filter-btn');
    const resetBtn = document.getElementById('reset-btn');

    const today = new Date().toISOString().slice(0,10);
    startDateInput.value = today;
    endDateInput.value = today;

    // Initial load
    fetchTrafficData({ startDate: today, endDate: today, searchQuery: '' });

    // Filter Button
    filterBtn.addEventListener('click', () => {
      fetchTrafficData({
        startDate: startDateInput.value,
        endDate: endDateInput.value,
        searchQuery: searchInput.value
      });
    });

    // Reset Button
    resetBtn.addEventListener('click', () => {
      startDateInput.value = today;
      endDateInput.value = today;
      searchInput.value = '';
      fetchTrafficData({ startDate: today, endDate: today, searchQuery: '' });
    });
  }

  // ======================
  // Websites Section Code
  // ======================
  // Elements
  const addWebsiteBtn = document.getElementById("addWebsiteBtn");
  const addWebsiteModal = document.getElementById("addWebsiteModal");
  const closeAddModal = document.getElementById("closeAddModal");
  const cancelWebsiteBtn = document.getElementById("cancelWebsiteBtn");
  const submitWebsiteBtn = document.getElementById("submitWebsiteBtn");

  const websiteNameInput = document.getElementById("websiteName");
  const websiteUrlInput = document.getElementById("websiteUrl");

  const websiteTableBody = document.getElementById("websiteTableBody");
  const emptyState = document.getElementById("emptyState");

  const getCodeModal = document.getElementById("getCodeModal");
  const closeGetCodeModal = document.getElementById("closeGetCodeModal");
  const codeSnippet = document.getElementById("codeSnippet");
  const copyCodeBtn = document.getElementById("copyCodeBtn");

  const searchInput = document.getElementById("searchInput");

  // Success and Error Modal Elements
  const successModal = document.getElementById("successModal");
  const closeSuccessModal = document.getElementById("closeSuccessModal");
  const successMessage = document.getElementById("successMessage");
  const successTimer = document.getElementById("successTimer");
  const countdownElement = document.getElementById("countdown");
  const okSuccessBtn = document.getElementById("okSuccessBtn");

  const errorModal = document.getElementById("errorModal");
  const closeErrorModal = document.getElementById("closeErrorModal");
  const errorMessage = document.getElementById("errorMessage");
  const okErrorBtn = document.getElementById("okErrorBtn");

  // Stats elements
  const totalWebsitesEl = document.getElementById("totalWebsites");
  const approvedWebsitesEl = document.getElementById("approvedWebsites");
  const pendingWebsitesEl = document.getElementById("pendingWebsites");
  const activeAdsEl = document.getElementById("activeAds");

  // Open Add Website modal
  addWebsiteBtn.onclick = () => {
    websiteNameInput.value = "";
    websiteUrlInput.value = "";
    addWebsiteModal.style.display = "block";
  };

  // Close modals
  closeAddModal.onclick = () => (addWebsiteModal.style.display = "none");
  cancelWebsiteBtn.onclick = () => (addWebsiteModal.style.display = "none");
  closeGetCodeModal.onclick = () => (getCodeModal.style.display = "none");
  closeSuccessModal.onclick = () => (successModal.style.display = "none");
  closeErrorModal.onclick = () => (errorModal.style.display = "none");

  // Success modal close events
  okSuccessBtn.onclick = () => {
    successModal.style.display = "none";
    if (countdownInterval) {
      clearInterval(countdownInterval);
    }
  };

  // Error modal close events
  okErrorBtn.onclick = () => {
    errorModal.style.display = "none";
  };

  window.onclick = (event) => {
    if (event.target === addWebsiteModal) addWebsiteModal.style.display = "none";
    if (event.target === getCodeModal) getCodeModal.style.display = "none";
    if (event.target === successModal) {
      successModal.style.display = "none";
      if (countdownInterval) {
        clearInterval(countdownInterval);
      }
    }
    if (event.target === errorModal) errorModal.style.display = "none";
  };

  // Countdown timer variable
  let countdownInterval;

  // Function to show success modal with countdown
  function showSuccessModal(message) {
    successMessage.textContent = message;
    successModal.style.display = "block";
    
    // Start countdown
    let countdown = 5;
    countdownElement.textContent = countdown;
    
    countdownInterval = setInterval(() => {
      countdown--;
      countdownElement.textContent = countdown;
      
      if (countdown <= 0) {
        clearInterval(countdownInterval);
        successModal.style.display = "none";
      }
    }, 1000);
  }

  // Function to show error modal
  function showErrorModal(message) {
    errorMessage.textContent = message;
    errorModal.style.display = "block";
  }

  // Submit Website
  submitWebsiteBtn.onclick = () => {
    const name = websiteNameInput.value.trim();
    const url = websiteUrlInput.value.trim();

    if (!name || !url) {
      showErrorModal("Please fill both Website Name and URL");
      return;
    }

    // Validate URL format
    if (!isValidUrl(url)) {
      showErrorModal("Please enter a valid URL (e.g., https://example.com)");
      return;
    }

    // Create data with default status and adsTxt
    const newWebsite = {
      name,
      url,
      status: "Pending",
      adsTxt: "Disabled",
      timestamp: Date.now()
    };

    const websitesRef = ref(database, "websites");
    push(websitesRef, newWebsite)
      .then(() => {
        showSuccessModal("Website submitted successfully! Status will be approved automatically in 5 seconds.");
        addWebsiteModal.style.display = "none";
        // Clear inputs
        websiteNameInput.value = "";
        websiteUrlInput.value = "";
      })
      .catch((err) => {
        showErrorModal("Error submitting website");
        console.error(err);
      });
  };

  // URL validation function
  function isValidUrl(string) {
    try {
      new URL(string);
      return true;
    } catch (_) {
      return false;
    }
  }

  // Update stats
  function updateStats(websites) {
    const total = Object.keys(websites).length;
    const approved = Object.values(websites).filter(w => w.status === "Approved").length;
    const pending = Object.values(websites).filter(w => w.status === "Pending").length;
    const active = Object.values(websites).filter(w => w.adsTxt === "Active").length;
    
    totalWebsitesEl.textContent = total;
    approvedWebsitesEl.textContent = approved;
    pendingWebsitesEl.textContent = pending;
    activeAdsEl.textContent = active;
  }

  // Listen for data changes & update table
  const websitesRef = ref(database, "websites");
  onValue(websitesRef, (snapshot) => {
    websiteTableBody.innerHTML = "";
    const data = snapshot.val();
    
    if (data) {
      emptyState.style.display = "none";
      updateStats(data);
      
      // Sort by timestamp ascending
      const entries = Object.entries(data).sort((a,b) => a[1].timestamp - b[1].timestamp);

      entries.forEach(([key, item]) => {
        const tr = document.createElement("tr");

        // Website Name
        const tdName = document.createElement("td");
        tdName.textContent = item.name;

        // Website Link
        const tdLink = document.createElement("td");
        const a = document.createElement("a");
        a.href = item.url;
        a.target = "_blank";
        a.rel = "noopener noreferrer";
        a.textContent = item.url;
        a.innerHTML = `<i class="fas fa-external-link-alt" style="margin-right: 5px;"></i> ${item.url}`;
        tdLink.appendChild(a);

        // Status
        const tdStatus = document.createElement("td");
        const statusSpan = document.createElement("span");
        statusSpan.className = `status ${item.status === "Approved" ? "status-approved" : "status-pending"}`;
        statusSpan.innerHTML = `<i class="fas ${item.status === "Approved" ? "fa-check-circle" : "fa-clock"}"></i> ${item.status}`;
        tdStatus.appendChild(statusSpan);

        // Ads TXT
        const tdAdsTxt = document.createElement("td");
        if (item.status === "Pending") {
          const badge = document.createElement("span");
          badge.className = "badge badge-disabled";
          badge.innerHTML = `<i class="fas fa-ban"></i> Disabled`;
          tdAdsTxt.appendChild(badge);
        } else if (item.status === "Approved") {
          const badge = document.createElement("span");
          badge.className = "badge badge-success";
          badge.innerHTML = `<i class="fas fa-check"></i> Active`;
          tdAdsTxt.appendChild(badge);
        } else {
          const badge = document.createElement("span");
          badge.className = "badge badge-disabled";
          badge.innerHTML = `<i class="fas fa-ban"></i> ${item.adsTxt || "Disabled"}`;
          tdAdsTxt.appendChild(badge);
        }

        // Actions
        const tdActions = document.createElement("td");
        if (item.status === "Approved") {
          const getCodeBtn = document.createElement("button");
          getCodeBtn.className = "btn btn-outline btn-sm";
          getCodeBtn.innerHTML = `<i class="fas fa-code"></i> Get Code`;
          getCodeBtn.onclick = () => {
            getCodeModal.style.display = "block";
          };
          tdActions.appendChild(getCodeBtn);
        } else {
          const pendingText = document.createElement("span");
          pendingText.textContent = "Pending approval";
          pendingText.style.color = "var(--gray)";
          pendingText.style.fontSize = "0.85rem";
          tdActions.appendChild(pendingText);
        }

        tr.appendChild(tdName);
        tr.appendChild(tdLink);
        tr.appendChild(tdStatus);
        tr.appendChild(tdAdsTxt);
        tr.appendChild(tdActions);

        websiteTableBody.appendChild(tr);
      });
    } else {
      emptyState.style.display = "block";
      updateStats({});
    }
  });

  // Copy code button functionality
  copyCodeBtn.onclick = () => {
    const code = codeSnippet.textContent;
    navigator.clipboard.writeText(code).then(() => {
      // Change button text temporarily
      const originalText = copyCodeBtn.innerHTML;
      copyCodeBtn.innerHTML = `<i class="fas fa-check"></i> Copied!`;
      setTimeout(() => {
        copyCodeBtn.innerHTML = originalText;
      }, 2000);
    }, () => {
      showErrorModal("Failed to copy code.");
    });
  };

  // Search functionality
  searchInput.addEventListener('input', (e) => {
    const searchTerm = e.target.value.toLowerCase();
    const rows = websiteTableBody.getElementsByTagName('tr');
    
    for (let row of rows) {
      const name = row.cells[0].textContent.toLowerCase();
      const url = row.cells[1].textContent.toLowerCase();
      
      if (name.includes(searchTerm) || url.includes(searchTerm)) {
        row.style.display = '';
      } else {
        row.style.display = 'none';
      }
    }
  });

  // Auto update status from Pending to Approved after 5 seconds per website
  onValue(websitesRef, (snapshot) => {
    const data = snapshot.val();
    if (data) {
      Object.entries(data).forEach(([key, item]) => {
        if (item.status === "Pending") {
          // check if 5 sec passed since timestamp
          const elapsed = Date.now() - item.timestamp;
          if (elapsed >= 5000) {
            // update status and adsTxt in Firebase
            update(ref(database, "websites/" + key), {
              status: "Approved",
              adsTxt: "Active"
            }).catch(console.error);
          } else {
            // schedule update for remaining time
            setTimeout(() => {
              update(ref(database, "websites/" + key), {
                status: "Approved",
                adsTxt: "Active"
              }).catch(console.error);
            }, 5000 - elapsed);
          }
        }
      });
    }
  });
</script>

</body>
</html>
